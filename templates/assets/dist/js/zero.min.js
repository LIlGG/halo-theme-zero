var g=Object.defineProperty;var m=(n,e,t)=>e in n?g(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var i=(n,e,t)=>(m(n,typeof e!="symbol"?e+"":e,t),t);var F=Object.defineProperty,l=Object.getOwnPropertyDescriptor,E=(n,e,t,s)=>{for(var o=s>1?void 0:s?l(e,t):e,c=n.length-1,u;c>=0;c--)(u=n[c])&&(o=(s?u(e,t,o):u(o))||o);return s&&o&&F(e,t,o),o};class d{registerTabsTag(){console.log("registerTabsTag")}}E([D()],d.prototype,"registerTabsTag",1);class h{constructor(e){i(this,"schemas");this.schemas=e}isEmpty(){return!this.schemas}getValue(e,t){if(!this.isEmpty()&&e.toString()in this.schemas)return new t(this.schemas.key)}}class a{constructor(){i(this,"documentFunctions");this.documentFunctions=new Map}geDocumentFunctionCount(){return this.documentFunctions.size}getDocumentFunctions(){return this.documentFunctions}getDocumentFunctionNames(){return this.documentFunctions.size===0?new Set:this.documentFunctions.keys()}registerDocumentFunction(e,t){this.documentFunctions.set(e,t)}getDocumentFunction(e){if(!!this.documentFunctions.has(e))return this.documentFunctions.get(e)}}class v{constructor(e){i(this,"config");i(this,"themeconfigs");i(this,"startupDate",new Date);i(this,"documentFunctionFactory",new a);i(this,"events",new Map);i(this,"REFRESH_EVENT_NAME","zero:refresh");this.config=e,this.themeconfigs=new Map,this.createThemeConfig()}createThemeConfig(){if(!this.config)return;let e=JSON.parse(this.config.toString());Object.keys(e).forEach(t=>{let s=new h(e[t]);this.themeconfigs.set(t,s)})}getThemeConfig(e){let t=this.themeconfigs.get(e);return t||new h}refresh(){this.prepareRefresh();let e=this.obtainFunctionFactory();this.registerDomProcessors(e),this.initEventMulticaster(),this.finishDocumentFunction(e),this.finishRefresh()}finishDocumentFunction(e){let t=e.getDocumentFunctions();for(let[s,o]of t)o()}obtainFunctionFactory(){return this.documentFunctionFactory||(this.documentFunctionFactory=new a),this.documentFunctionFactory}prepareRefresh(){this.startupDate=new Date,this.getThemeConfig("advanced").getValue("log",Boolean)&&console.log("Zero Refreshing"),this.refreshMetadata()}refreshMetadata(){}registerDomProcessors(e){p().forEach((s,o)=>{e.registerDocumentFunction(o,s)}),this.getThemeConfig("advanced").getValue("log",Boolean)&&console.log("共获取预设 documentFunction "+e.geDocumentFunctionCount()+" 个")}initEventMulticaster(){let e=this.events.get(this.REFRESH_EVENT_NAME);e||(e=new CustomEvent(this.REFRESH_EVENT_NAME.toString()),this.events.set(this.REFRESH_EVENT_NAME,e))}finishRefresh(){let e=this.events.get(this.REFRESH_EVENT_NAME);window.dispatchEvent(e),this.getThemeConfig("advanced").getValue("log",Boolean)&&console.log("finish Refreshing")}}let f;document.addEventListener("DOMContentLoaded",()=>{f=new v(config),f.refresh()});var r;function p(){return r}function D(){return function(n,e,t){r||(r=new Map),r.set(e,n[e])}}window.addEventListener("zero:refresh",()=>{console.log("event -> refresh")});export{f as z};
//# sourceMappingURL=zero.min.js.map
